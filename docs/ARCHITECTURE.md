# ChatBot é¡¹ç›®æ¶æ„æ–‡æ¡£

## ğŸ“Š é‡æ„æ€»è§ˆ

åŸæœ¬çš„ `ChatBot.tsx` (330 è¡Œ) å·²è¢«é‡æ„ä¸º 6 ä¸ªç‹¬ç«‹çš„æ¨¡å—ï¼Œéµå¾ª**é«˜å†…èšã€ä½è€¦åˆ**çš„è®¾è®¡åŸåˆ™ã€‚

## ğŸ¯ é‡æ„å‰åå¯¹æ¯”

### é‡æ„å‰ âŒ

```
src/
â”œâ”€â”€ ChatBot.tsx (330è¡Œ)  â† æ‰€æœ‰é€»è¾‘æ··åœ¨ä¸€èµ·
â”œâ”€â”€ ChatBot.css
â””â”€â”€ widget.tsx
```

**é—®é¢˜**ï¼š

- âŒ ç»„ä»¶è¿‡å¤§ï¼Œéš¾ä»¥ç»´æŠ¤
- âŒ èŒè´£ä¸æ¸…æ™°
- âŒ éš¾ä»¥æµ‹è¯•
- âŒ éš¾ä»¥å¤ç”¨
- âŒ å›¢é˜Ÿåä½œå›°éš¾

### é‡æ„å âœ…

```
src/
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ ChatBot.tsx (40è¡Œ)       â† ä¸»å®¹å™¨ï¼Œç»„åˆå­ç»„ä»¶
â”‚   â”œâ”€â”€ ChatHeader.tsx (110è¡Œ)   â† å¤´éƒ¨UI
â”‚   â”œâ”€â”€ Message.tsx (40è¡Œ)       â† å•æ¡æ¶ˆæ¯
â”‚   â”œâ”€â”€ MessageList.tsx (35è¡Œ)   â† æ¶ˆæ¯åˆ—è¡¨
â”‚   â”œâ”€â”€ ChatInput.tsx (115è¡Œ)    â† è¾“å…¥æ¡†
â”‚   â”œâ”€â”€ useChatBot.ts (130è¡Œ)    â† ä¸šåŠ¡é€»è¾‘
â”‚   â”œâ”€â”€ types.ts (55è¡Œ)          â† ç±»å‹å®šä¹‰
â”‚   â”œâ”€â”€ index.ts (10è¡Œ)          â† ç»Ÿä¸€å¯¼å‡º
â”‚   â””â”€â”€ README.md                â† æ¶æ„æ–‡æ¡£
â”œâ”€â”€ ChatBot.css
â””â”€â”€ widget.tsx
```

**ä¼˜åŠ¿**ï¼š

- âœ… æ¯ä¸ªæ–‡ä»¶èŒè´£å•ä¸€
- âœ… ä»£ç æ˜“äºç†è§£å’Œç»´æŠ¤
- âœ… ç»„ä»¶å¯ç‹¬ç«‹æµ‹è¯•
- âœ… ä¾¿äºå›¢é˜Ÿå¹¶è¡Œå¼€å‘
- âœ… é«˜å¤ç”¨æ€§

## ğŸ—ï¸ æ¶æ„è®¾è®¡

### ç»„ä»¶å±‚çº§ç»“æ„

```
ChatBot (å®¹å™¨)
â”œâ”€â”€ ChatHeader (å¤´éƒ¨)
â”‚   â”œâ”€â”€ æ ‡ç­¾é¡µåˆ‡æ¢
â”‚   â”œâ”€â”€ æœºå™¨äººä¿¡æ¯
â”‚   â””â”€â”€ ç¤¾äº¤é“¾æ¥
â”œâ”€â”€ MessageList (æ¶ˆæ¯åˆ—è¡¨)
â”‚   â””â”€â”€ Message Ã— N (å•æ¡æ¶ˆæ¯)
â””â”€â”€ ChatInput (è¾“å…¥æ¡†)
    â”œâ”€â”€ å·¥å…·æŒ‰é’®
    â”œâ”€â”€ è¾“å…¥æ¡†
    â””â”€â”€ å‘é€æŒ‰é’®
```

### æ•°æ®æµå‘

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          useChatBot Hook                â”‚
â”‚  (çŠ¶æ€ç®¡ç† + ä¸šåŠ¡é€»è¾‘)                   â”‚
â”‚                                         â”‚
â”‚  - messages                             â”‚
â”‚  - inputValue                           â”‚
â”‚  - activeTab                            â”‚
â”‚  - handleSend()                         â”‚
â”‚  - handleQuickAction()                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            ChatBot                      â”‚
â”‚  (ç»„åˆç»„ä»¶ï¼Œåè°ƒäº¤äº’)                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â†“           â†“           â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ChatHeaderâ”‚ â”‚MessageListâ”‚ â”‚ChatInput â”‚
â”‚   (UI)    â”‚ â”‚   (UI)    â”‚ â”‚  (UI)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ§© ç»„ä»¶è¯¦è§£

### 1. ChatBot.tsx - ä¸»å®¹å™¨

**è¡Œæ•°**: ~40 è¡Œ  
**èŒè´£**: ç»„åˆå­ç»„ä»¶ï¼Œåè°ƒäº¤äº’  
**ç‰¹ç‚¹**: æ— å…·ä½“ UI å®ç°ï¼Œåªåšç»„è£…

```tsx
const ChatBot: React.FC<ChatBotProps> = ({ onClose }) => {
  const {
    messages,
    inputValue,
    activeTab,
    setInputValue,
    setActiveTab,
    handleSend,
    handleQuickAction,
  } = useChatBot();

  return (
    <div className="chatbot-container">
      <ChatHeader {...headerProps} />
      <MessageList {...listProps} />
      <ChatInput {...inputProps} />
    </div>
  );
};
```

### 2. ChatHeader.tsx - å¤´éƒ¨ç»„ä»¶

**è¡Œæ•°**: ~110 è¡Œ  
**èŒè´£**: æ˜¾ç¤ºå¤´éƒ¨æ‰€æœ‰ UI å…ƒç´   
**å†…å®¹**: æ ‡ç­¾é¡µã€æœºå™¨äººä¿¡æ¯ã€ç¤¾äº¤é“¾æ¥

### 3. Message.tsx - å•æ¡æ¶ˆæ¯

**è¡Œæ•°**: ~40 è¡Œ  
**èŒè´£**: æ˜¾ç¤ºå•æ¡æ¶ˆæ¯  
**ç‰¹ç‚¹**: çº¯å±•ç¤ºç»„ä»¶ï¼Œæ ¹æ®ç±»å‹è‡ªé€‚åº”æ ·å¼

### 4. MessageList.tsx - æ¶ˆæ¯åˆ—è¡¨

**è¡Œæ•°**: ~35 è¡Œ  
**èŒè´£**: ç®¡ç†æ¶ˆæ¯åˆ—è¡¨å’Œè‡ªåŠ¨æ»šåŠ¨  
**ç‰¹ç‚¹**: åŒ…å«æ»šåŠ¨é€»è¾‘

### 5. ChatInput.tsx - è¾“å…¥æ¡†

**è¡Œæ•°**: ~115 è¡Œ  
**èŒè´£**: å¤„ç†ç”¨æˆ·è¾“å…¥  
**ç‰¹ç‚¹**: å—æ§ç»„ä»¶ï¼Œæ”¯æŒ Enter é”®å‘é€

### 6. useChatBot.ts - ä¸šåŠ¡é€»è¾‘ Hook

**è¡Œæ•°**: ~130 è¡Œ  
**èŒè´£**: ç®¡ç†æ‰€æœ‰çŠ¶æ€å’Œä¸šåŠ¡é€»è¾‘  
**ç‰¹ç‚¹**: åˆ†ç¦» UI å’Œé€»è¾‘

### 7. types.ts - ç±»å‹å®šä¹‰

**è¡Œæ•°**: ~55 è¡Œ  
**èŒè´£**: TypeScript ç±»å‹å®šä¹‰  
**ç‰¹ç‚¹**: é›†ä¸­ç®¡ç†ç±»å‹ï¼Œé¿å…é‡å¤

## ğŸ¨ è®¾è®¡æ¨¡å¼

### 1. ç»„åˆæ¨¡å¼ (Composition Pattern)

å°†å¤§ç»„ä»¶æ‹†åˆ†ä¸ºå°ç»„ä»¶ï¼Œé€šè¿‡ç»„åˆå®ç°åŠŸèƒ½

### 2. å®¹å™¨/å±•ç¤ºæ¨¡å¼ (Container/Presentational Pattern)

- **å®¹å™¨ç»„ä»¶**: ChatBot (ç®¡ç†çŠ¶æ€å’Œé€»è¾‘)
- **å±•ç¤ºç»„ä»¶**: ChatHeader, Message, MessageList, ChatInput (åªè´Ÿè´£ UI)

### 3. è‡ªå®šä¹‰ Hook æ¨¡å¼ (Custom Hook Pattern)

ä½¿ç”¨ `useChatBot` å°è£…ä¸šåŠ¡é€»è¾‘ï¼Œæé«˜å¤ç”¨æ€§

### 4. å•ä¸€èŒè´£åŸåˆ™ (Single Responsibility Principle)

æ¯ä¸ªç»„ä»¶åªæœ‰ä¸€ä¸ªæ”¹å˜çš„ç†ç”±

### 5. å¼€é—­åŸåˆ™ (Open/Closed Principle)

å¯¹æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å…³é—­

## ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–å»ºè®®

### 1. ä½¿ç”¨ React.memo

```tsx
export default React.memo(Message);
```

### 2. ä½¿ç”¨ useCallback

```tsx
const handleSend = useCallback(() => {
  // ...
}, [dependencies]);
```

### 3. è™šæ‹Ÿæ»šåŠ¨

å¦‚æœæ¶ˆæ¯æ•°é‡å¾ˆå¤§ï¼Œè€ƒè™‘ä½¿ç”¨ `react-window`

### 4. æ‡’åŠ è½½

```tsx
const ChatInput = React.lazy(() => import("./ChatInput"));
```

## ğŸ§ª æµ‹è¯•ç­–ç•¥

### å•å…ƒæµ‹è¯•

æ¯ä¸ªç»„ä»¶å¯ç‹¬ç«‹æµ‹è¯•ï¼š

```tsx
// Message.test.tsx
describe("Message", () => {
  it("should render bot message", () => {
    const message = {
      id: 1,
      type: "bot",
      content: "Hello",
      timestamp: "12:00",
    };
    render(<Message message={message} />);
    expect(screen.getByText("Hello")).toBeInTheDocument();
  });
});
```

### é›†æˆæµ‹è¯•

æµ‹è¯•ç»„ä»¶ä¹‹é—´çš„äº¤äº’ï¼š

```tsx
// ChatBot.test.tsx
describe("ChatBot", () => {
  it("should send message when click send button", () => {
    render(<ChatBot />);
    const input = screen.getByPlaceholderText("è¾“å…¥ä¿¡æ¯...");
    const sendBtn = screen.getByRole("button", { name: /send/i });

    fireEvent.change(input, { target: { value: "Test" } });
    fireEvent.click(sendBtn);

    expect(screen.getByText("Test")).toBeInTheDocument();
  });
});
```

## ğŸš€ æ„å»ºç»“æœ

```bash
dist/chatbot-widget.css        5.05 kB â”‚ gzip:  1.56 kB
dist/chatbot-widget.iife.js  203.85 kB â”‚ gzip: 64.28 kB
```

**ä¼˜åŒ–**ï¼š

- âœ… æ–‡ä»¶å¤§å°åˆç†
- âœ… gzip å‹ç¼©æ•ˆæœå¥½
- âœ… æ¨¡å—æ•°é‡å¢åŠ ä½†æ€»ä½“ç§¯æœªæ˜¾è‘—å¢é•¿

## ğŸ“ ä»£ç è´¨é‡æŒ‡æ ‡

| æŒ‡æ ‡         | é‡æ„å‰ | é‡æ„å | æ”¹å–„   |
| ------------ | ------ | ------ | ------ |
| æœ€å¤§æ–‡ä»¶è¡Œæ•° | 330 è¡Œ | 130 è¡Œ | â¬‡ï¸ 60% |
| ç»„ä»¶å¤æ‚åº¦   | é«˜     | ä½     | âœ…     |
| å¯æµ‹è¯•æ€§     | å›°éš¾   | å®¹æ˜“   | âœ…     |
| å¯ç»´æŠ¤æ€§     | ä½     | é«˜     | âœ…     |
| å¯å¤ç”¨æ€§     | ä½     | é«˜     | âœ…     |

## ğŸ“ å­¦ä¹ èµ„æº

- [React ç»„ä»¶è®¾è®¡æ¨¡å¼](https://react.dev/learn/thinking-in-react)
- [SOLID åŸåˆ™](https://en.wikipedia.org/wiki/SOLID)
- [ä»£ç æ•´æ´ä¹‹é“](https://www.amazon.com/Clean-Code-Handbook-Software-Craftsmanship/dp/0132350882)

## ğŸ‘¥ è´¡çŒ®æŒ‡å—

### æ·»åŠ æ–°ç»„ä»¶

1. åœ¨ `src/components/` ä¸‹åˆ›å»ºæ–°æ–‡ä»¶
2. åœ¨ `types.ts` ä¸­å®šä¹‰ç±»å‹
3. åœ¨ `index.ts` ä¸­å¯¼å‡º
4. ç¼–å†™ç»„ä»¶æ–‡æ¡£

### ä¿®æ”¹ç°æœ‰ç»„ä»¶

1. åªä¿®æ”¹ç›¸å…³ç»„ä»¶ï¼Œä¸å½±å“å…¶ä»–ç»„ä»¶
2. ä¿æŒ Props æ¥å£å‘åå…¼å®¹
3. æ›´æ–°ç›¸å…³æµ‹è¯•

### ä»£ç è§„èŒƒ

- ä½¿ç”¨ TypeScript
- éµå¾ª ESLint è§„åˆ™
- æ·»åŠ å¿…è¦çš„æ³¨é‡Š
- ä¿æŒç»„ä»¶èŒè´£å•ä¸€

## ğŸ“ è”ç³»æ–¹å¼

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·æäº¤ Issue æˆ– PRã€‚

---

**é‡æ„å®Œæˆæ—¥æœŸ**: 2025-11-10  
**é‡æ„äºº**: AI Assistant  
**ç‰ˆæœ¬**: 2.0.0
