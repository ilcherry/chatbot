# test-simple.html 系统消息功能说明

## 📋 概述

`test-simple.html` 现已集成系统消息功能，可以在常用的测试场景中直观地展示系统消息的效果。

## ✨ 新增功能

### 1. 初始系统消息

打开聊天窗口后，会立即看到一条系统消息：

```
┌──────────────────────────────────┐
│  机器人：欢迎使用SaleSmarty        │
├──────────────────────────────────┤
│        🟢 客服已上线              │  ← 系统消息（居中显示）
├──────────────────────────────────┤
│  [按钮] salesmartly使用指南       │
│  [按钮] 使用常见问题              │
└──────────────────────────────────┘
```

### 2. 快速操作时的系统消息

点击快速操作按钮（如"使用常见问题"）时，会显示：

1. 用户消息："使用常见问题"
2. **系统消息**："⚡ 正在为您查询..." （居中显示）
3. 机器人回复：相关问题列表

### 3. 发送消息时的系统消息

在输入框中输入并发送消息时，会显示：

1. 用户消息：您输入的内容
2. **系统消息**："💾 消息已保存" （居中显示）
3. 机器人回复："感谢您的消息！我们会尽快回复您。"

## 🎨 视觉效果

### 系统消息特征

- ✅ **居中对齐** - 不同于左对齐（机器人）和右对齐（用户）的消息
- ✅ **灰色背景** - `rgba(0, 0, 0, 0.05)` 浅灰色，低调不干扰
- ✅ **小字体** - 12px，比普通消息（14px）更小
- ✅ **圆角设计** - 12px 圆角，与整体风格一致
- ✅ **Emoji 图标** - 使用 emoji 增强识别度

### 消息对比

```
┌─────────────────────────────────────┐
│                                     │
│  ┌─┐  ┌──────────────────────┐    │
│  │●│  │ 机器人消息（左对齐）   │    │  ← 白色背景，14px
│  └─┘  └──────────────────────┘    │
│              时间戳                 │
│                                     │
│         ┌──────────────┐           │
│         │ 系统消息     │           │  ← 灰色背景，12px，居中
│         └──────────────┘           │
│              时间戳                 │
│                                     │
│    ┌──────────────────────┐  ┌─┐  │
│    │ 用户消息（右对齐）     │  │U│  │  ← 蓝色背景，14px
│    └──────────────────────┘  └─┘  │
│                      时间戳         │
│                                     │
└─────────────────────────────────────┘
```

## 🧪 测试步骤

### 步骤 1: 启动测试页面

```bash
# 方法 1: Python HTTP Server
python3 -m http.server 8080

# 方法 2: Node.js http-server
npx http-server -p 8080

# 方法 3: PHP 内置服务器
php -S localhost:8080
```

然后访问：`http://localhost:8080/test-simple.html`

### 步骤 2: 验证初始系统消息

1. 点击页面上的 **"打开聊天窗口"** 按钮
2. 聊天窗口会在右下角打开
3. 查看消息列表，应该能看到：
   - 第一条：机器人消息 "欢迎使用SaleSmarty"
   - **第二条：系统消息 "🟢 客服已上线"（居中显示）**
   - 第三条：快速操作按钮 "salesmartly使用指南"
   - 第四条：快速操作按钮 "使用常见问题"

### 步骤 3: 测试快速操作系统消息

1. 点击 **"使用常见问题"** 快速操作按钮
2. 观察消息流程：
   - 用户消息出现："使用常见问题"
   - 0.3秒后，**系统消息出现："⚡ 正在为您查询..."**（居中显示）
   - 1.2秒后，机器人回复出现：常见问题列表

### 步骤 4: 测试发送消息系统消息

1. 在输入框中输入："你好"
2. 点击发送按钮（或按回车）
3. 观察消息流程：
   - 用户消息出现："你好"
   - 0.5秒后，**系统消息出现："💾 消息已保存"**（居中显示）
   - 1.5秒后，机器人回复出现："感谢您的消息！我们会尽快回复您。"

## 📊 系统消息配置

当前在 `useChatBot.ts` 中配置的系统消息：

### 初始消息

```typescript
{
  id: 2,
  type: "system",
  content: "🟢 客服已上线",
  timestamp: "11-10 16:27:53",
}
```

### 发送消息时

```typescript
{
  type: "system",
  content: "💾 消息已保存",
  timestamp: "",  // 不显示时间戳
}
```

### 快速操作时

```typescript
{
  type: "system",
  content: "⚡ 正在为您查询...",
  timestamp: "",  // 不显示时间戳
}
```

## 🎯 使用场景展示

### 场景 1: 客服上线通知

```
时间: 打开聊天窗口时
系统消息: "🟢 客服已上线"
用途: 告知用户当前有客服在线，可以即时回复
```

### 场景 2: 查询处理中

```
时间: 点击快速操作时
系统消息: "⚡ 正在为您查询..."
用途: 提供即时反馈，告知用户系统正在处理请求
```

### 场景 3: 消息保存确认

```
时间: 发送消息后
系统消息: "💾 消息已保存"
用途: 确认消息已成功保存，增强用户信心
```

## 💡 自定义建议

### 修改系统消息内容

编辑 `src/components/useChatBot.ts`：

```typescript
// 修改初始系统消息
{
  id: 2,
  type: "system",
  content: "🟢 客服已上线",  // ← 修改这里
  timestamp: "11-10 16:27:53",
}

// 修改发送消息时的系统消息
{
  type: "system",
  content: "💾 消息已保存",  // ← 修改这里
  timestamp: "",
}

// 修改快速操作时的系统消息
{
  type: "system",
  content: "⚡ 正在为您查询...",  // ← 修改这里
  timestamp: "",
}
```

### 添加更多系统消息场景

可以在其他业务逻辑中添加系统消息，例如：

```typescript
// 上传文件时
const systemMessage: Message = {
  id: messages.length + 1,
  type: "system",
  content: "📎 文件上传中...",
  timestamp: "",
};
setMessages((prev) => [...prev, systemMessage]);

// 网络错误时
const systemMessage: Message = {
  id: messages.length + 1,
  type: "system",
  content: "⚠️ 网络连接失败，请检查网络",
  timestamp: generateTimestamp(),
};
setMessages((prev) => [...prev, systemMessage]);
```

## 🔍 调试技巧

### 1. 控制台输出

打开浏览器开发者工具（F12），在 test-simple.html 的控制台输出区域可以看到：

```
[16:27:52] [INFO] 开始初始化 ChatBot Widget...
[16:27:52] [SUCCESS] ChatBotWidget 类已成功加载
[16:27:52] [SUCCESS] ChatBotWidget 实例已创建
[16:27:52] [SUCCESS] ChatBotWidget 初始化成功！
[16:27:52] [INFO] 页面加载完成
[16:27:52] [SUCCESS] 所有测试通过！✨
[16:27:52] [INFO] 💡 提示：打开聊天窗口后可以看到系统消息功能（居中显示的灰色消息）
```

### 2. 检查系统消息样式

在浏览器开发者工具中检查系统消息元素：

```html
<div class="message system">
  <div class="system-message-content">
    <div class="system-message-text">🟢 客服已上线</div>
    <div class="system-message-timestamp">11-10 16:27:53</div>
  </div>
</div>
```

对应的 CSS：

```css
.message.system {
  display: flex;
  justify-content: center;
  align-items: center;
  margin: 12px 0;
}

.system-message-text {
  background: rgba(0, 0, 0, 0.05);
  color: #666;
  padding: 6px 12px;
  border-radius: 12px;
  font-size: 12px;
}
```

## 📱 响应式测试

系统消息在不同屏幕尺寸下的表现：

### 桌面端（> 768px）
- 最大宽度：80%
- 字体大小：12px
- 完整显示所有内容

### 移动端（< 768px）
- 最大宽度：90%
- 字体大小：11px
- 自动换行

## ✅ 验收标准

测试通过的标准：

- [x] 打开聊天窗口后能看到初始系统消息 "🟢 客服已上线"
- [x] 系统消息居中显示，灰色背景
- [x] 系统消息字体比普通消息小
- [x] 点击快速操作后显示 "⚡ 正在为您查询..." 系统消息
- [x] 发送消息后显示 "💾 消息已保存" 系统消息
- [x] 系统消息的淡入动画效果流畅
- [x] 没有控制台错误
- [x] 所有交互功能正常

## 🎉 总结

`test-simple.html` 现在完整支持系统消息功能，您可以：

1. ✅ 快速验证系统消息的视觉效果
2. ✅ 测试不同场景下的系统消息
3. ✅ 作为系统消息功能的演示页面
4. ✅ 用于日常开发测试

系统消息为聊天机器人增添了更丰富的交互体验！

